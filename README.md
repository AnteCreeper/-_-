
<div style="text-align: center;">
  <img src="LOGO.png" width="600" alt="Logo">
</div>

# Описание
Этот скрипт выполняет отслеживание и мониторинг различных типов железнодорожных вагонов на видеозаписи или в режиме реального времени с камеры. Он использует модель YOLO для обнаружения объектов, определяет их тип и проверяет пересечения вагонов с заданными рельсовыми участками для контроля занятости путей.

## Требования
- `Python 3.8` или выше
- Установленные библиотеки:
  - `OpenCV` для захвата видео и визуализации: `cv2`
  - `NumPy` для работы с массивами и координатами: `numpy`
  - YOLO от `Ultralytics` для выполнения инференса на видео: `ultralytics`
- Для установки необходимых библиотек:

```bash
pip install opencv-python-headless numpy ultralytics
```
## Структура кода
Типы вагонов (`wagon_dict`) - словарь для отображения индекса класса в название типа вагона.
Координаты рельсов (`rails_coordinates`) - список массивов, где каждый массив описывает координаты рельса в виде точек.
Модель YOLO - загружается предобученная модель YOLO для детекции объектов.
### Вспомогательные функции:
- `line_intersection`: проверяет пересечение двух линий.
- `intersection_point`: вычисляет точку пересечения двух линий, если они пересекаются.
Основная функция `track_and_monitor`:
Открывает видео или камеру, выполняет инференс YOLO для обнаружения объектов, рисует рамки вокруг обнаруженных объектов, вычисляет их пересечения с рельсами и подсчитывает количество вагонов каждого типа на разных участках.
Визуализирует участки рельсов и отображает информацию о типах и количестве вагонов на экране.
## Использование
Подготовьте обученную модель YOLO и сохраните веса модели в файл `best.pt`.
Убедитесь, что видеозапись (`video.mp4`) находится в папке проекта или замените путь в коде на путь к вашему видеофайлу.
Запустите скрипт, вызвав функцию `track_and_monitor` с указанием источника видео:
```python
track_and_monitor("video.mp4")
```
## Пример работы
Скрипт будет отображать видеопоток, где:
- Вагоны обнаруживаются и обводятся прямоугольниками.
- Визуализируются участки рельсов.
- Отображается текстовая информация о типах и количестве вагонов на экране.

## Завершение работы
Для завершения работы скрипта нажмите клавишу q.
